<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Deal with the network issue of UDP services with Clash TUN mode enabled - 4xpl0r3r&#039;s blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="4xpl0r3r&#039;s blog"><meta name="msapplication-TileImage" content="/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="4xpl0r3r&#039;s blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="When the TUN mode is enable in Clash, local UDP service can’t build connection with clients on the Internet. How to diagnose it? How to fix it?"><meta property="og:type" content="blog"><meta property="og:title" content="Deal with the network issue of UDP services with Clash TUN mode enabled"><meta property="og:url" content="https://www.4xpl0r3r.com/Experience/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/"><meta property="og:site_name" content="4xpl0r3r&#039;s blog"><meta property="og:description" content="When the TUN mode is enable in Clash, local UDP service can’t build connection with clients on the Internet. How to diagnose it? How to fix it?"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144359702.png"><meta property="og:image" content="https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144451892.png"><meta property="og:image" content="https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144918734.png"><meta property="og:image" content="https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144946166.png"><meta property="og:image" content="https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145054536.png"><meta property="og:image" content="https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145229874.png"><meta property="og:image" content="https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145313016.png"><meta property="og:image" content="https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145830292.png"><meta property="og:image" content="https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145708448.png"><meta property="og:image" content="https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229150452204.png"><meta property="og:image" content="https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229154654997.png"><meta property="article:published_time" content="2024-02-29T09:00:00.000Z"><meta property="article:modified_time" content="2024-02-29T09:18:33.307Z"><meta property="article:author" content="4xpl0r3r"><meta property="article:tag" content="Network"><meta property="article:tag" content="Troubleshooting"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="../../img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144359702.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.4xpl0r3r.com/Experience/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/"},"headline":"Deal with the network issue of UDP services with Clash TUN mode enabled","image":["https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144359702.png","https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144451892.png","https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144918734.png","https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144946166.png","https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145054536.png","https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145229874.png","https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145313016.png","https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145830292.png","https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145708448.png","https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229150452204.png","https://www.4xpl0r3r.com/img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229154654997.png"],"datePublished":"2024-02-29T09:00:00.000Z","dateModified":"2024-02-29T09:18:33.307Z","author":{"@type":"Person","name":"4xpl0r3r"},"publisher":{"@type":"Organization","name":"4xpl0r3r's blog","logo":{"@type":"ImageObject","url":{"text":"4xpl0r3r"}}},"description":"When the TUN mode is enable in Clash, local UDP service can’t build connection with clients on the Internet. How to diagnose it? How to fix it?"}</script><link rel="canonical" href="https://www.4xpl0r3r.com/Experience/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/"><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.15.2/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/monokai.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?3fec34a29e38d2bb96785908e568c11f";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-997MZZV1T0" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-997MZZV1T0');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="follow_it-verification-code" content="7RZ9jE39c8SCaWnWQPl8"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="4xpl0r3r's blog" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">4xpl0r3r</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/4xpl0r3r"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-02-29T09:00:00.000Z" title="2/29/2024, 5:00:00 PM">2024-02-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-02-29T09:18:33.307Z" title="2/29/2024, 5:18:33 PM">2024-02-29</time></span><span class="level-item"><a class="link-muted" href="/categories/Experience/">Experience</a></span><span class="level-item">7 minutes read (About 1055 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Deal with the network issue of UDP services with Clash TUN mode enabled</h1><div class="content"><p>When the TUN mode is enable in Clash, local UDP service can’t build connection with clients on the Internet. How to diagnose it? How to fix it?</p>
<span id="more"></span>

<article class="message message-immersive is-primary">
<div class="message-body">
<i class="fas fa-globe-asia mr-2"></i>This article is also available in 
<a target="_blank" rel="noopener" href="https://cn.4xpl0r3r.com/经验/Clash-TUN模式下的UDP服务异常诊断与解决/">简体中文</a>.
</div>
</article>




<h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>I’m used to use the TUN mode of ClashX to takeover all the network traffic in my MacOS system to observe the real-time traffic and configure the traffic routing. As the open source alternative of Surge, ClashX has been my actual outbound traffic management center and outbound firewall in my MacOS system.</p>
<blockquote>
<p>To manage the inbound traffic for MacOS, I still recommend the built-in PF firewall</p>
</blockquote>
<p>Recently, with the popularity of the <em>PalWorld</em>, I set up the dedicated server in my MacOS with Docker. However, the users from Internet can not connect to my server while everything worked well in my LAN. ( I have the public IP, configured the port mapping)</p>
<h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><h3 id="Diagnose-the-incoming-and-outgoing-for-UDP-amp-TCP"><a href="#Diagnose-the-incoming-and-outgoing-for-UDP-amp-TCP" class="headerlink" title="Diagnose the incoming and outgoing for UDP&amp;TCP"></a>Diagnose the incoming and outgoing for UDP&amp;TCP</h3><p>First, I perform diagnostics on the incoming and outgoing TCP and UDP traffic</p>
<p>TCP outgoing traffic, it’s easy to test and find that everything works well.</p>
<p><img src="../../img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144359702.png" alt="image-20240229144359702"></p>
<p><img src="../../img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144451892.png" alt="image-20240229144451892"></p>
<p>TCP incoming traffic, according to the screenshots below, the communication is normal. The packets from both client and server are received successfully.</p>
<p><img src="../../img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144918734.png" alt="image-20240229144918734"></p>
<p><img src="../../img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229144946166.png" alt="image-20240229144946166"></p>
<p>UDP outgoing traffic, here I tried to access the Google NTP service. we can find that the connection succeeded.</p>
<p><img src="../../img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145054536.png" alt="image-20240229145054536"></p>
<p>UDP ingoing traffic, let’s set up the listening service at the first.</p>
<p><img src="../../img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145229874.png" alt="image-20240229145229874"></p>
<p>Tried to send an UDP packet, we can see the packet is received successfully. It seems like the UDP listening service works well, but really?</p>
<p><img src="../../img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145313016.png" alt="image-20240229145313016"></p>
<p>Tried to send the response packet, it can’t be received. Tried to send the packet from client side again, it can’t be received too.</p>
<p><img src="../../img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145830292.png" alt="image-20240229145830292"></p>
<p><img src="../../img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229145708448.png" alt="image-20240229145708448"></p>
<blockquote>
<p>At this time, test in the LAN or without enabling on TUN mode. All connections are normal. The method is the same. So let’s skip them.</p>
</blockquote>
<h3 id="Diagnosis-with-Wireshark"><a href="#Diagnosis-with-Wireshark" class="headerlink" title="Diagnosis with Wireshark"></a>Diagnosis with Wireshark</h3><p>Now we have confirm the issue, let’s dive deeper with Wireshark. While listening with Wireshark, reproduce the above problematic operation.</p>
<blockquote>
<p>You may notice my public IP and ports changed, IP changed from 218.79.x.x to 117.131.x.x, the port is 50011 now. Don’t care this.</p>
</blockquote>
<p>We can find the successfully sent UDP packet with destination port 50011, we received this packet in the server side successfully.</p>
<p><img src="../../img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229150452204.png" alt="image-20240229150452204"></p>
<p>The 2nd packet is sent back from the server side, but the client side didn’t received that. We can find the source port in the screenshot, it’s 50131 which is not the same as the service listening port 50011. I believe it’s because Clash remapped the source port in the TUN NIC to avoiding conflict when several proxy clients use the same source port. Then because the source port is different from the destination port in the client side and the client was using the widely used port restricted cone NAT( called NAT in the PlayStation ), the connection failed. But if the client was using restricted cone NAT (NAT2) or full cone NAT (NAT1), I believe the connection could succeed.</p>
<h2 id="Solve-it"><a href="#Solve-it" class="headerlink" title="Solve it"></a>Solve it</h2><p>Now we have located the root cause - UDP service outgoing traffic flow through the TUN NIC, which made the source port change, so the client with NAT3 rejects the connection. How to solve it?</p>
<h3 id="Solution-1-Configure-the-route-table-manually"><a href="#Solution-1-Configure-the-route-table-manually" class="headerlink" title="Solution 1 - Configure the route table manually"></a>Solution 1 - Configure the route table manually</h3><p>Since the problem is that the traffic passes through the TUN NIC, we can specify routing table rules for the specific client IP to use the physical NIC directly and ignore the TUN NIC.</p>
<p>In MacOS, I use the following command to indicate the traffic flowing to <code>117.131.x.x</code> to use the <code>en20</code> physical NIC and solved the issue successfully.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo route add 117.131.x.x -interface en20</span><br></pre></td></tr></table></figure>

<p>It’s also feasible to change the ClashX client to <a target="_blank" rel="noopener" href="https://github.com/MetaCubeX/ClashX.Meta">ClashX.Meta</a>, which allows us to make more detailed configuration for the the TUN mode. Therefore, we can write the configuration file to exclude specific CIDR block automatically when enabling the TUN mode.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tun:</span></span><br><span class="line">  <span class="attr">inet4-route-exclude-address:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="number">117.131</span><span class="string">.x.x/32</span></span><br></pre></td></tr></table></figure>

<h4 id="Cons"><a href="#Cons" class="headerlink" title="Cons"></a>Cons</h4><ul>
<li>This approach can’t deal with the problem when there are massive clients.</li>
</ul>
<h3 id="Solution-2-Utilize-port-forwarding-tools"><a href="#Solution-2-Utilize-port-forwarding-tools" class="headerlink" title="Solution 2 - Utilize port forwarding tools"></a>Solution 2 - Utilize port forwarding tools</h3><p>Some port forwarding tools like <a target="_blank" rel="noopener" href="https://github.com/ginuerzh/gost">gost</a> can specify the listening port and send the response packet from the correspond NIC.</p>
<p>Here the gost bind the physical NIC (<code>192.168.x.x</code>) and redirect the traffic to the real service.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gost -L=udp://192.168.x.x:50111/127.0.0.1:50112</span><br></pre></td></tr></table></figure>

<p>Here we can see the packets from both client and server sides are received succesfully.</p>
<p><img src="../../img/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/image-20240229154654997.png" alt="image-20240229154654997"></p>
<h4 id="Cons-1"><a href="#Cons-1" class="headerlink" title="Cons"></a>Cons</h4><ul>
<li>The traffic is redirected in the application layer, which increase the server performance pressure and increase the network latency</li>
<li>The server-side application can’t identify the real client IP address anymore.</li>
</ul>
<h3 id="Solution-3-Bridge-the-NIC"><a href="#Solution-3-Bridge-the-NIC" class="headerlink" title="Solution 3 - Bridge the NIC"></a>Solution 3 - Bridge the NIC</h3><blockquote>
<p>Just a assumption, not tested</p>
</blockquote>
<p>It’s feasible to use Vmware to create a bridged NIC which connect to the physical NIC directly to ignore the Clash TUN NIC.</p>
<h4 id="Cons-2"><a href="#Cons-2" class="headerlink" title="Cons"></a>Cons</h4><ul>
<li>The port forwarding function in the router may not work with the bridge NIC to make the connection fail. ( I met this condition, my k662c router can’t forward a port to a IP address of a bridge NIC)</li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>Deal with the network issue of UDP services with Clash TUN mode enabled</p><p><a href="https://www.4xpl0r3r.com/Experience/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/">https://www.4xpl0r3r.com/Experience/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>4xpl0r3r</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2024-02-29</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2024-02-29</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Network/">Network</a><a class="link-muted mr-2" rel="tag" href="/tags/Troubleshooting/">Troubleshooting</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/Red-Blue/C2-Payload-Hiding-and-Memory-Forensics/"><span class="level-item">C2 Payload Hiding and Memory Forensics</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "915bccd4e7bf07c22c5fe4ce2bd62480",
            repo: "Blog-Comments",
            owner: "4xpl0r3r",
            clientID: "9497fa90b0fed6513d24",
            clientSecret: "355dce85acb10c44d73d459e0087635c3d1404cb",
            admin: ["4xpl0r3r"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar1.png" alt="4xpl0r3r"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">4xpl0r3r</p><p class="is-size-6 is-block">OSCE3 | OSCP | CTFer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Orange Cyberdefense, Shanghai</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">21</p></a></div></div></nav><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/4xpl0r3r"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:4xpl0r3r@gmail.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="https://api.follow.it/subscription-form/bGV4KzhoNzZNdk0rZ1Q0VDhvWlNucE5UYzFwZzVZZFJBaTdLRWxDRXVlenU2Q0k0SzFVUTA3OWtSSnNNa2NNaHdVNUtyVXFNVXBtUWpTT3VSVlE0ZysrWEdxMTFFQVFnV2tZUksrd0d3a1crVFgyaTBVbUhTRUplZVV3YnVNaDh8VjAxd1dmVEdzVzgvSTZMV3dXK1FHbGhFL2ZTdGl3b0FKeWk0YnZmQ2MyND0=/8" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Background"><span class="level-left"><span class="level-item">Background</span></span></a></li><li><a class="level is-mobile" href="#Troubleshooting"><span class="level-left"><span class="level-item">Troubleshooting</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Diagnose-the-incoming-and-outgoing-for-UDP-amp-TCP"><span class="level-left"><span class="level-item">Diagnose the incoming and outgoing for UDP&amp;TCP</span></span></a></li><li><a class="level is-mobile" href="#Diagnosis-with-Wireshark"><span class="level-left"><span class="level-item">Diagnosis with Wireshark</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Solve-it"><span class="level-left"><span class="level-item">Solve it</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Solution-1-Configure-the-route-table-manually"><span class="level-left"><span class="level-item">Solution 1 - Configure the route table manually</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Cons"><span class="level-left"><span class="level-item">Cons</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Solution-2-Utilize-port-forwarding-tools"><span class="level-left"><span class="level-item">Solution 2 - Utilize port forwarding tools</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Cons-1"><span class="level-left"><span class="level-item">Cons</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Solution-3-Bridge-the-NIC"><span class="level-left"><span class="level-item">Solution 3 - Bridge the NIC</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Cons-2"><span class="level-left"><span class="level-item">Cons</span></span></a></li></ul></li></ul></li></ul></div></div><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://cn.4xpl0r3r.com/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Switch Language - 简体中文</span></span><span class="level-right"><span class="level-item tag">cn.4xpl0r3r.com</span></span></a></li><li><a class="level is-mobile" href="https://github.com/4xpl0r3r" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">GitHub</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li><li><a class="level is-mobile" href="https://medium.com/@4xpl0r3r" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Medium</span></span><span class="level-right"><span class="level-item tag">medium.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Certifications/"><span class="level-start"><span class="level-item">Certifications</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Docs/"><span class="level-start"><span class="level-item">Docs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Experience/"><span class="level-start"><span class="level-item">Experience</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Red-Blue/"><span class="level-start"><span class="level-item">Red&amp;Blue</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Vuln-Analysis/"><span class="level-start"><span class="level-item">Vuln-Analysis</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-29T09:00:00.000Z">2024-02-29</time></p><p class="title"><a href="/Experience/Deal-with-the-network-issue-of-UDP-services-with-Clash-TUN-mode-enabled/">Deal with the network issue of UDP services with Clash TUN mode enabled</a></p><p class="categories"><a href="/categories/Experience/">Experience</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-03-13T08:45:43.000Z">2023-03-13</time></p><p class="title"><a href="/Red-Blue/C2-Payload-Hiding-and-Memory-Forensics/">C2 Payload Hiding and Memory Forensics</a></p><p class="categories"><a href="/categories/Red-Blue/">Red&amp;Blue</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-02-14T06:24:24.000Z">2023-02-14</time></p><p class="title"><a href="/Experience/Using-CodeQL-to-find-out-Log4j-CVE-2021-44228/">Using CodeQL to find out Log4j CVE-2021-44228</a></p><p class="categories"><a href="/categories/Experience/">Experience</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-30T03:46:14.000Z">2022-01-30</time></p><p class="title"><a href="/Vuln-Analysis/Vulnerability-Analysis-CVE-2021-4034-Linux-Polkit-Privilege-Escalation/">Vulnerability-Analysis - CVE-2021-4034 Linux Polkit Privilege Escalation</a></p><p class="categories"><a href="/categories/Vuln-Analysis/">Vuln-Analysis</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-27T14:39:50.000Z">2022-01-27</time></p><p class="title"><a href="/Certifications/OSCE3-Review-OSCP-OSEP-OSWE-OSED/">OSCE3 Review (OSCP+OSEP+OSWE+OSED)</a></p><p class="categories"><a href="/categories/Certifications/">Certifications</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">February 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/03/"><span class="level-start"><span class="level-item">March 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">February 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">January 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Antivirus-Evasion/"><span class="tag">Antivirus Evasion</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Blue-Teaming/"><span class="tag">Blue Teaming</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C#</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C-C/"><span class="tag">C&amp;C++</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C2/"><span class="tag">C2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CVE/"><span class="tag">CVE</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CodeQL/"><span class="tag">CodeQL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Environment/"><span class="tag">Environment</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Format-String/"><span class="tag">Format String</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JNDI/"><span class="tag">JNDI</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Memory-Forensics/"><span class="tag">Memory Forensics</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Network/"><span class="tag">Network</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OffSec/"><span class="tag">OffSec</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PWN/"><span class="tag">PWN</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PowerShell/"><span class="tag">PowerShell</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Priv-Escalation/"><span class="tag">Priv-Escalation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Red-Teaming/"><span class="tag">Red Teaming</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Troubleshooting/"><span class="tag">Troubleshooting</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">4xpl0r3r</a><p class="is-size-7"><span>&copy; 2024 4xpl0r3r</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>